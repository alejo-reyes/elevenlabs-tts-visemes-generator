# ElevenLabs Text-to-Speech Viseme Generator

_Author: AReyes (<alejo.reyes@gmail.com>)_

This project generates speech audio and corresponding viseme (lip sync) data from a text prompt using the ElevenLabs API.  
**Note:** Viseme data generation is limited to words found in the CMU Pronouncing Dictionary (English only). Words not present in the CMU dictionary will be matched to the most similar CMU word using the `fastest-levenshtein` algorithm.

It maps spoken words to phonemes and then to visemes for animation or analysis.

## Features

- Converts text to speech (MP3) using ElevenLabs.
- Extracts word-level timestamps and phonemes.
- Maps phonemes to visemes for lip sync animation.
- Outputs both audio and viseme data:
  - **Audio:** MP3 file.
  - **Viseme data:** JSON file containing an array of objects  
    `{ timestamp: number, viseme: string }`  
    representing the viseme sequence and timing for each word.

## Folder Structure

- `src/text-to-speech.js` — Main script for generating audio and viseme data.
- `input/speech.txt` — **Provide your input text here.**
- `output/` — Contains generated files:
  - `speech_longer.mp3` — Generated speech audio.
  - `speech_longer_viseme_data.json` — Viseme track data.
- `.env` — Stores your ElevenLabs API key and voice ID.
- `package.json` — Project dependencies and scripts.

## Setup

1. **Install dependencies:**
   ```sh
   npm install
   ```

2. **Add your ElevenLabs API key and voice ID to `.env`:**
   ```
   ELEVEN_LABS_API_KEY = "your_api_key_here"
   ELEVEN_LABS_VOICE_ID = "your_voice_id_here"
   ```

3. **Provide your input text:**
   - Edit or replace the contents of `input/speech.txt` with your desired prompt.

## Usage

Run text-to-speech with optional input/output arguments:
```sh
npm run elabs:tts [ -- --input ./input/custom.txt ] [ --output ./output/custom_name ]
```

- By default, input is read from `./input/speech.txt`.
- By default, output files are saved as `./output/speech_longer.mp3` and `./output/speech_longer_viseme_data.json`.
- You can specify a custom input file using the `--input` or `-i` argument (e.g. `--input ./input/mytext.txt`).
- You can specify a custom output path and base name using the `--output` or `-o` argument (e.g. `--output ./output/myfile`).

If the input text file is missing or empty, the script will exit with an error.

## Utilities

You can use the following utility scripts:

- `src/elabs-account-status.js` — Displays your ElevenLabs account and subscription details in a formatted table.
- `src/elabs-voices.js` — Lists all available voices and their IDs in a formatted table.

Run them with:

```sh
npm run elabs:account
```

```sh
npm run elabs:voices
```

## Dependencies

- [@elevenlabs/elevenlabs-js](https://www.npmjs.com/package/@elevenlabs/elevenlabs-js)
- [cmu-pronouncing-dictionary](https://www.npmjs.com/package/cmu-pronouncing-dictionary)
- [dotenv](https://www.npmjs.com/package/dotenv)
- [fastest-levenshtein](https://www.npmjs.com/package/fastest-levenshtein)
- [node-id3](https://www.npmjs.com/package/node-id3)
- [yargs](https://www.npmjs.com/package/yargs)

## License

ISC

---

Generated by [src/index.js](src/index.js)